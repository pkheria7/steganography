# Standard and third-party imports
from PIL import Image, ImageDraw
import random

# Local module imports
from common import message_to_binary, binary_to_message, encode_number, decode_number, generate_starting_points
from encrypt import dfs_encryption
from decrypt import dfs_decryption
from config import get_depth_limit, get_height, get_width, get_password

# --- Helper Functions ---
def create_white_canvas(input_image_path: str):
    """Create a white canvas with the same dimensions as the input image."""
    img = Image.open(input_image_path).convert("RGBA")
    width, height = img.size
    white_canvas = Image.new("RGBA", (width, height), "white")  # Create a white canvas
    return white_canvas

def password_in_image(pixels, password: str):
    """Embed the binary password into the image's pixels."""
    count = 0
    for x in range(10, 266):
        draw.point((x,1),fill="red")
        r, g, b, a = pixels[x, 1]
        r = (r & ~1) | int(password[count])
        pixels[x, 1] = (r, g, b, a)
        count+=1

def decode_in_image(pixels) -> str:
    """Extract the embedded password from the image's pixels."""
    y = 1
    message = ""
    for x in range(10, 266):
        r, _, _, _ = pixels[x, y]
        message += str(r & 1)
    return message

def binary_to_hex(binary_string: str) -> str:
    """Convert a 256-bit binary string to a 64-digit hexadecimal string."""
    return hex(int(binary_string, 2))[2:].zfill(64)

def hex_to_binary(hex_string: str) -> str:
    """Convert a 64-digit hexadecimal string to a 256-bit binary string."""
    return bin(int(hex_string, 16))[2:].zfill(256)

def get_message() -> str:
    """Returns the default message to hide."""
    return "The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs.The stars blinked above, silent witnesses to dreams whispered in the dark. She wandered far, chasing echoes of hope and fragments of forgotten songs."

# --- Core Functions ---

def encrypting(input_image_path: str, start_points: list, password: str):
    """Encrypt and embed a message into the image."""
    img = Image.open(input_image_path).convert("RGBA")
    width, height = img.size
    get_width(width)
    get_height(height)
    pixels = img.load()
    password_in_image(pixels, password)
    visited = set(start_points)
    path = []
    enc_msg = message_to_binary(get_message())

    data_index = 0
    i = 0
    while data_index < len(enc_msg):
        start_x, start_y = start_points[i]
        next_start_x, next_start_y = start_points[i + 1]
        next_point_binary = encode_number(next_start_x) + encode_number(next_start_y)
        enc_msg = enc_msg[:data_index] + next_point_binary + enc_msg[data_index:]
        data_index = dfs_encryption(start_x, start_y, False, enc_msg, pixels, visited, path, data_index)
        i += 1
    for (vx, vy) in visited:
        draw.point((vx, vy), fill="blue")

    
    img.save("graph_based_hashing.png")

def decrypting(start_points: list, start: tuple) -> str:
    """Extract and decrypt the hidden message from the image."""
    img = Image.open("graph_based_hashing.png").convert("RGBA")
    pixels = img.load()

    user_password = hex_to_binary(input("Enter your password :"))

    if(user_password != decode_in_image(pixels)):
        return "Password does not match"

    visited = set(start_points)
    path = []
    final_message = ""

    start_x, start_y = start
    while True:
        message_extraction = dfs_decryption(start_x, start_y, False, pixels, visited, path, "")
        next_x = decode_number(message_extraction[0:16])
        next_y = decode_number(message_extraction[16:32])
        done, check = binary_to_message(message_extraction[32:])
        final_message += done
        start_x, start_y = next_x, next_y
        if check:
            break

    return final_message

# --- Main Execution ---

if __name__ == "__main__":
    input_image_path = "/Users/piyushkheria/Desktop/steganography/test.png"
    canvas = create_white_canvas(input_image_path)
    draw = ImageDraw.Draw(canvas)
    word = input("Enter a word (must not be more than 15 letters):\n")
    if len(word) > 15:
        word = word[:15]
    word = word.ljust(15, 'z')  # pad if less than 15

    checkpoint = get_password(word)
    prime = int(input("Choose one (17, 19, 21, 23):\n"))
    get_depth_limit(prime)
    randomise_it = int(input("Your favourite number :\n"))

    # Generate starting points
    img = Image.open(input_image_path).convert("RGBA")
    width, height = img.size
    start_points = generate_starting_points(width, height, randomise_it, 50)
    start = start_points[0]
    for (sx, sy) in start_points:
        draw.point((sx, sy), fill="green")
    # Create password embedding
    My_password = (
        encode_number(width) +
        encode_number(height) +
        "11111111" +
        encode_number(prime) +
        "11111111" +
        encode_number(start[0]) +
        encode_number(start[1]) +
        "11111111" +
        encode_number(randomise_it) +
        "11111111" +
        message_to_binary(word)
    )
    print(len(get_message()))
    # Encrypt and save the image
    encrypting(input_image_path, start_points, My_password)
    
    # Your password in the Hex to Display
    print("This is your hex code :\n",binary_to_hex(My_password)) 

    # Shuffle starting points before decryption
    random.shuffle(start_points)

    # Decrypt and validate
    extracted_message = decrypting(start_points, start)
    print("Message matching:", extracted_message == get_message())
    print(extracted_message)
    canvas.save("path_canvas.png")
    canvas.show()